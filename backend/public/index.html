<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval'; script-src * 'unsafe-inline' 'unsafe-eval'; connect-src *; img-src * data: blob: 'unsafe-inline'; frame-src *; style-src * 'unsafe-inline';">
  <title>Backend API Tester</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Backend API Tester</h1>
      <p>Testing interface for Smart Queue System | Base URL: /api</p>
      <p>
        <strong>Template Fetch Example:</strong><br>
        <code style="background: #f0f0f0; padding: 4px 8px; display: block; margin-top: 5px; font-size: 0.85rem;">
          fetch('/api/&lt;endpoint&gt;', {<br>
          &nbsp;&nbsp;method: '&lt;method&gt;',<br>
          &nbsp;&nbsp;headers: { 'Content-Type': 'application/json' },<br>
          &nbsp;&nbsp;credentials: '&lt;credentials&gt;',<br>
          &nbsp;&nbsp;body: JSON.stringify({ &lt;key&gt;: &lt;value&gt; })<br>
          }).then(res => res.json()).then(data => console.log(data));
        </code>
      </p>
    </div>

    <div class="grid">
      <!-- Database Stats -->
      <div class="card">
        <h2>Database Statistics</h2>
        <p>View current database state and record counts</p>
        <button onclick="getStats()">Get Stats</button>
        <div id="stats-loading" class="loading">Loading...</div>
        <div id="stats-response"></div>
      </div>

      <!-- Institutes -->
      <div class="card">
        <h2>Institutes</h2>
        <p>View all registered institutes</p>
        <button onclick="getInstitutes()">Get All Institutes</button>
        <div id="institutes-loading" class="loading">Loading...</div>
        <div id="institutes-response" class="response-box"></div>
      </div>

      <!-- Services -->
      <div class="card">
        <h2>Services</h2>
        <p>View all available services</p>
        <button onclick="getServices()">Get All Services</button>
        <div id="services-loading" class="loading">Loading...</div>
        <div id="services-response" class="response-box"></div>
      </div>

      <!-- Institute Info -->
      <div class="card institute-card">
        <h2>Institute Info</h2>
        <p>Get complete institute information</p>
        <button onclick="getInstituteInfo()">GET /api/institute/info</button>
        <div id="institute-info-loading" class="loading">Loading...</div>
        <div id="institute-info-response" class="response-box"></div>
      </div>

      <!-- Institute Services -->
      <div class="card institute-card">
        <h2>Institute Services</h2>
        <p>Get list of institute services</p>
        <button onclick="getInstituteServices()">GET /api/institute/services</button>
        <div id="institute-services-loading" class="loading">Loading...</div>
        <div id="institute-services-response" class="response-box"></div>
      </div>

      <!-- Service Form -->
      <div class="card institute-card">
        <h2>Service Form</h2>
        <p>Get form by service ID</p>
        <input type="number" id="service-id" placeholder="Service ID (0, 1, 2...)" value="0">
        <button onclick="getServiceForm()">GET /api/institute/form/:id</button>
        <div id="service-form-loading" class="loading">Loading...</div>
        <div id="service-form-response" class="response-box"></div>
      </div>

      <!-- Privacy Notice -->
      <div class="card institute-card">
        <h2>Privacy Notice</h2>
        <p>Get institute privacy notice</p>
        <button onclick="getPrivacyNotice()">GET /api/institute/notice</button>
        <div id="privacy-loading" class="loading">Loading...</div>
        <div id="privacy-response" class="response-box"></div>
      </div>

      <!-- Chatbot - Ping -->
      <div class="card">
        <h2>Chatbot Ping</h2>
        <p>Test if chatbot endpoint is responding</p>
        <button onclick="pingChatbot()">Ping Chatbot</button>
        <div id="ping-loading" class="loading">Loading...</div>
        <div id="ping-response" class="response-box"></div>
      </div>

      <!-- Chatbot - Start -->
      <div class="card">
        <h2>Start Conversation</h2>
        <p>Initialize a new chatbot conversation</p>
        <button onclick="startConversation()">Send "start"</button>
        <div id="start-loading" class="loading">Loading...</div>
        <div id="start-response" class="response-box"></div>
      </div>

      <!-- Chatbot - Feedback -->
      <div class="card">
        <h2>Request Feedback</h2>
        <p>Request user feedback options</p>
        <button onclick="requestFeedback()">Send "feedback"</button>
        <div id="feedback-loading" class="loading">Loading...</div>
        <div id="feedback-response" class="response-box"></div>
      </div>

      <!-- Custom Closed Message -->
      <div class="card">
        <h2>Custom Closed Message</h2>
        <p>Send a custom closed-ended message</p>
        <input type="text" id="closed-message" placeholder="Enter message (e.g., 'start', 'feedback')">
        <button onclick="sendClosedMessage()">Send Message</button>
        <div id="closed-loading" class="loading">Loading...</div>
        <div id="closed-response" class="response-box"></div>
      </div>

      <!-- Open-ended Message -->
      <div class="card">
        <h2>Open-ended Message</h2>
        <p>Send a custom open-ended message</p>
        <textarea id="open-message" rows="3" placeholder="Type your message here..."></textarea>
        <button onclick="sendOpenMessage()">Send Message</button>
        <div id="open-loading" class="loading">Loading...</div>
        <div id="open-response" class="response-box"></div>
      </div>

      <!-- Sessions -->
      <div class="card">
        <h2>Active Sessions</h2>
        <p>View all active chat sessions</p>
        <button onclick="getSessions()">Get Sessions</button>
        <button onclick="clearResponse('sessions-response')">Clear</button>
        <div id="sessions-loading" class="loading">Loading...</div>
        <div id="sessions-response" class="response-box"></div>
      </div>

      <!-- Queue -->
      <div class="card">
        <h2>Queue Status</h2>
        <p>View current waiting queue</p>
        <button onclick="getQueue()">Get Queue</button>
        <div id="queue-loading" class="loading">Loading...</div>
        <div id="queue-response" class="response-box"></div>
      </div>

      <!-- Tables -->
      <div class="card">
        <h2>Database Tables</h2>
        <p>List all database tables</p>
        <button onclick="getTables()">Get Tables</button>
        <div id="tables-loading" class="loading">Loading...</div>
        <div id="tables-response" class="response-box"></div>
      </div>

      <!-- QR Code -->
      <div class="card">
        <h2>QR Code Generator</h2>
        <p>Generate QR code for test page</p>
        <button onclick="getQR()">Generate QR</button>
        <div id="qr-loading" class="loading">Loading...</div>
        <div id="qr-response" class="response-box"></div>
      </div>

      <!-- Session & Devices -->
      <div class="card">
        <h2>Session & Devices</h2>
        <p>Check session and device information</p>
        <button onclick="getSession()">GET /session</button>
        <button onclick="getDevices()">GET /devices</button>
        <button onclick="getServerCheck()">GET /server/check</button>
        <div id="session-loading" class="loading">Loading...</div>
        <div id="session-response" class="response-box"></div>
      </div>

      <!-- Counters List -->
      <div class="card">
        <h2>Counters</h2>
        <p>Manage counter operations</p>
        <button onclick="getCounters()">GET /counters</button>
        <button onclick="createCounter()">POST /counters (create)</button>
        <div id="counters-loading" class="loading">Loading...</div>
        <div id="counters-response" class="response-box"></div>
      </div>

      <!-- Counter by ID -->
      <div class="card">
        <h2>Counter by ID</h2>
        <p>Get, update, or delete a specific counter</p>
        <input type="text" id="counter-sessionId" placeholder="Enter session ID">
        <button onclick="getCounterById()">GET /counters/:id</button>
        <button onclick="deleteCounterById()">DELETE /counters/:id</button>
        <div id="counter-id-loading" class="loading">Loading...</div>
        <div id="counter-id-response" class="response-box"></div>
      </div>

      <!-- Update Counter -->
      <div class="card">
        <h2>Update Counter</h2>
        <p>Update counter status and properties</p>
        <input type="text" id="counter-update-sessionId" placeholder="Enter session ID">
        <textarea id="counter-data" rows="4" placeholder='{"status": "active", "counterId": "counter-123"}'>{
  "status": "active"
}</textarea>
        <button onclick="updateCounter()">PUT /counters/:id</button>
        <div id="counter-update-loading" class="loading">Loading...</div>
        <div id="counter-update-response" class="response-box"></div>
      </div>
    </div>
  </div>

  <script src="script.js"></script>
</body>
</html>
